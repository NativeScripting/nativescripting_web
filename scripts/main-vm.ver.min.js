function reorderCats(e){tCats.unshift(tCats.splice(tCats.findIndex(function(t){return t.catId===e}),1)[0])}function CategoryVm(e){var t=this;t.catId=e.catId,t.name=e.name}function BundleVm(e,t,o){var r=this;r.id=e.id,r.title=e.title,r.subtitle=e.subtitle,r.url=e.url,r.promototal=e.promototal,r.promoremaining=e.promoremaining,r.bundleLevel=e.bundleLevel,r.courseIds=e.courseIds,r.productSingle=ko.observable(null),r.productsTeam=ko.observableArray([]),r.deselectAllBundlesCallback=o,r.courseSummaries=ko.observableArray([]);for(var n=[],s=0;s<e.products.length;s++){var c=new ProductVm(e.products[s],e.tag);1===c.licensesMin?r.productSingle(c):n.push(c)}n.push(new ProductVm({type:"contact"},e.tag)),r.productsTeam(n);for(var a=[],u=t.filter(function(e){return r.courseIds.indexOf(e.id)>-1}),l=0;l<u.length;l++)a.push(new CourseSummaryVm(u[l]));r.courseSummaries(a),r.showMessage=ko.observable(!1),r.singleSelected=ko.pureComputed(function(){var e=r.selectedProduct();return!!e&&1===e.licensesMin}),r.toggleTeamSelecting=function(){console.log("bundle toggleTeamSelecting"),r.teamSelecting(!r.teamSelecting())},r.teamSelected=ko.pureComputed(function(){var e=r.selectedProduct();return!!e&&(e.licensesMin>1||"contact"===e.type)}),r.toggleCoursesShowing=function(){console.log("bundle toggleCoursesShowing"),r.coursesShowing(!r.coursesShowing())},r.teamSelecting=ko.observable(!1),r.coursesShowing=ko.observable(!1),r.bundleSelected=ko.observable(!1),r.selectedProduct=ko.observable(null),r.selectProduct=function(e){r.deselectAllBundlesCallback(),"string"==typeof e&&"single"===e?r.selectedProduct(r.productSingle()):(e.type,r.selectedProduct(e)),r.bundleSelected(!0),r.showMessage(!1)},r.teamTop=ko.pureComputed(function(){return r.teamSelected()?r.selectedProduct():r.productsTeam()[0]}),r.teamTopIsContact=ko.pureComputed(function(){return"contact"===r.teamTop().type}),r.teamUsersTop=ko.pureComputed(function(){return r.teamTop().usersDisp()}),r.teamPriceSaleTop=ko.pureComputed(function(){return r.teamTop().priceSaleDisp()}),r.teamPriceRegTop=ko.pureComputed(function(){return r.teamTop().priceRegDisp()}),r.deselectBundle=function(){console.log("deselecting bundle: "+r.title),r.bundleSelected(!1),r.selectedProduct(null),r.showMessage(!1)},r.getBundleUrl=ko.pureComputed(function(){return"https://sso.teachable.com/secure/89912/checkout/confirmation?product_id="+r.selectedProduct().id+"&course_id="+r.id}),r.buyBundle=function(){if(!r.selectedProduct())return r.deselectAllBundlesCallback(),r.showMessage(!0),!1;var e=r.getBundleUrl();window.location=e}}function AuthorVm(e){var t=this;t.name=e.name,t.bio=e.bio,t.title=e.title,t.picture="/img/authors/"+e.picture}function ProductVm(e,t){var o=this;o.id=e.id,o.type=e.type,o.licensesMin=e.licensesMin,o.licensesMax=e.licensesMax,o.pricereg=e.pricereg,o.pricesale=e.pricesale,o.tag=t,o.priceRegDisp=ko.pureComputed(function(){return 0===o.pricereg?"FREE":o.pricereg}),o.priceSaleDisp=ko.pureComputed(function(){return 0===o.pricesale?"FREE":o.pricesale}),o.usersDisp=ko.pureComputed(function(){return 1!==o.licensesMin||"NEW"!==o.tag&&"PRESALE"!==o.tag?o.licensesMin+"-"+o.licensesMax+" users":"Launch"})}function LessonVm(e,t){var o=this;o.chapterId=e.id,o.id=t.id,o.name=t.name,o.lessonNumber=t.lessonNumber,o.chapter=e,o.startLesson=function(){window.location=tBaseUrl+"/courses/"+o.chapter.course.url+"/lectures/"+o.id}}function ChapterVm(e,t){var o=this;o.id=t.id,o.name=t.name,o.lessons=ko.observableArray([]),o.course=e;for(var r=[],n=0;n<t.lessons.length;n++)r.push(new LessonVm(o,t.lessons[n]));o.lessons(r)}function CourseSummaryVm(e){var t=this;t.id=e.id,t.title=e.title,t.level=e.level,t.authors=e.authors,t.authorNames=ko.pureComputed(function(){return t.authors.map(function(e){return e.name}).join(", ")}),t.getLevelIcon=function(e){return e["l"+t.level]}}function CourseVm(e){var t=this;t.id=e.id,t.title=e.title,t.subtitle=e.subtitle,t.description=e.description,t.categories=e.categories,t.tag=e.tag,t.level=e.level,t.launchdate=e.launchdate,t.url=e.url,t.authors=ko.observableArray([]),t.productSingle=ko.observable(null),t.productsTeam=ko.observableArray([]),t.chapters=ko.observableArray([]),t.numLessons=ko.observable(0);for(var o=[],r=[],n=[],s=0;s<e.authors.length;s++)o.push(new AuthorVm(e.authors[s]));for(var c=0;c<e.products.length;c++){var a=new ProductVm(e.products[c],e.tag);1===a.licensesMin?t.productSingle(a):r.push(a)}r.push(new ProductVm({type:"contact"},e.tag));for(var u=0,l=0;l<e.chapters.length;l++){for(var i=0;i<e.chapters[l].lessons.length;i++)u++,e.chapters[l].lessons[i].lessonNumber=u;n.push(new ChapterVm(t,e.chapters[l]))}t.authors(o),t.productsTeam(r),t.chapters(n),t.numLessons(u),t.courseIcons=ko.pureComputed(function(){var e=[];return t.categories.indexOf("core")>-1&&e.push("/img/nativescript_white.svg"),t.categories.indexOf("ng")>-1&&e.push("/img/nativescript_angular.svg"),e}),t.courseIcon=ko.pureComputed(function(){return t.courseIcons()[0]}),t.getLevelIcon=function(e){return e["l"+t.level]},t.singleSelected=ko.pureComputed(function(){var e=t.selectedProduct();return!!e&&1===e.licensesMin}),t.toggleTeamSelecting=function(){t.teamSelecting(!t.teamSelecting())},t.teamSelected=ko.pureComputed(function(){var e=t.selectedProduct();return!!e&&(e.licensesMin>1||"contact"===e.type)}),t.teamSelecting=ko.observable(!1),t.selectedProduct=ko.observable(null),t.contactSelected=ko.observable(null),t.selectProduct=function(e){console.log("selectProduct"),"string"==typeof e&&"single"===e?t.selectedProduct(t.productSingle()):(e.type,t.selectedProduct(e)),t.showMessage(!1)},t.teamTop=ko.pureComputed(function(){return t.teamSelected()?t.selectedProduct():t.productsTeam()[0]}),t.teamTopIsContact=ko.pureComputed(function(){return"contact"===t.teamTop().type}),t.teamUsersTop=ko.pureComputed(function(){return t.teamTop().usersDisp()}),t.teamPriceSaleTop=ko.pureComputed(function(){return t.teamTop().priceSaleDisp()}),t.teamPriceRegTop=ko.pureComputed(function(){return t.teamTop().priceRegDisp()}),t.goToCourseDetailPage=function(){window.location.href;isLocalDevEnvironment()?window.location="detail.html?id="+t.url:window.location="course/"+t.url},t.courseUrl=ko.pureComputed(function(){return"https://sso.teachable.com/secure/89912/checkout/confirmation?product_id="+t.selectedProduct().id+"&course_id="+t.id}),t.showMessage=ko.observable(!1),t.getCourse=function(){var e=t.selectedProduct();if(!e)return t.showMessage(!0),!1;if("contact"===e.type)return t.showMessage(!0),!1;var o=t.courseUrl();window.location=o}}function MainNavVm(){this.goToAboutPage=function(){isLocalDevEnvironment()?window.location="/about.html":window.location="/about"}}function CatPickerVm(){var e=this;if(e.selectedCategory=ko.observable(),e.categories=ko.pureComputed(function(){e.selectedCategory();return tCats}),e.syncSelectedCat=function(e){localStorage.setItem("sel-cat",e.catId)},e.selectCategory=function(t){reorderCats(t),e.selectedCategory(tCats[0]),e.syncSelectedCat(tCats[0])},null===localStorage.getItem("sel-cat"))e.selectCategory(initialCatId);else{var t=localStorage.getItem("sel-cat");e.selectCategory(t)}}function CoursesPageVm(e){var t=this;t.mainNav=new MainNavVm,t.catPicker=new CatPickerVm,t.catPicker.selectedCategory.subscribe(function(){t.filterCoursesByCategory()}),t.catSelectorActive=ko.observable(!1),t.courses=ko.observableArray([]),t.bundles=ko.observableArray([]),t.deselectAllBundles=function(){for(var e=t.bundles(),o=0;o<e.length;o++)e[o].deselectBundle()},t.allCourses=[];for(var o=0;o<e.courses.length;o++)t.allCourses.push(new CourseVm(e.courses[o]));for(var r=0;r<e.bundles.length;r++)t.bundles.push(new BundleVm(e.bundles[r],e.courses,t.deselectAllBundles));t.toggleCatSelectorActive=function(){t.catSelectorActive(!t.catSelectorActive())},t.selectCategoryParent=function(e){t.catSelectorActive()&&t.selectCategoryDirect(e)},t.selectCategoryDirect=function(e){t.catPicker.selectCategory(e)},t.filterCoursesByCategory=function(){var e=t.catPicker.selectedCategory(),o=t.allCourses.filter(function(t){return t.categories.indexOf(e.catId)>-1});t.courses(o)},t.filterCoursesByCategory()}function DetailPageVm(e,t){var o=this;o.mainNav=new MainNavVm;var r=e.courses.find(function(e){return e.url===t});o.course=new CourseVm(r),o.bundles=ko.observableArray([]),o.deselectAllBundles=function(){console.log("details deseleccting all bundles");for(var e=o.bundles(),t=0;t<e.length;t++)e[t].deselectBundle()};for(var n=0;n<e.bundles.length;n++)o.bundles.push(new BundleVm(e.bundles[n],e.courses,o.deselectAllBundles))}function bootstrapCoursesPage(){$.getJSON(coursesDataUrl,function(e){ko.applyBindings(new CoursesPageVm(e))})}function bootstrapDetailsPage(){$.getJSON(coursesDataUrl,function(e){var t=getBaseName(window.location.href);isLocalDevEnvironment()&&(t=getParameterByName("id")),ko.applyBindings(new DetailPageVm(e,t))})}function getBaseName(e){if(!e||e&&0===e.length)return"";var t=e.lastIndexOf("/")+1,o=e.substr(t).split(/[.?&#]+/)[0];return 0===o.length&&(o=getBaseName(e=e.substr(0,t-1))),o||""}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function isLocalDevEnvironment(){return window.location.href.indexOf("127.")>-1}var ko=ko||{},$=$||{},tBaseUrl="http://nativescripting.teachable.com",coursesDataUrl="coursesdata.json?v=1.0.1",tCats=[new CategoryVm({catId:"core",name:"NativeScript Core"}),new CategoryVm({catId:"ng",name:"NativeScript with Angular"})],initialCatId="ng";